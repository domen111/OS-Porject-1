OS Project 1
===

## Design
Process Scheduling

```
typedef struct process{
    char name[MAX_NAME_LENGTH];
    int ready_time;
    int exec_time;
    int ID;
}PROCESS;
```
上為process的結構
我們將scheduling與processing分別寫成兩份code，並且在編譯執行schedule.c前，事先編譯process.c。
開始執行schedule，待資料process輸入後，首先，我們將資料process透過qsort並根據他們的ready-time做排序，接著按著排序的結果開始fork個別的child-process，fork出來process後，會呼叫Insert_Process函式放入waiting_list做排序，根據不同的scheduling policy分別有不同的排序法，FIFO及RR就按照fork出來的先後排序，而SJF與PSJF則要依exec_time，小的在前大的在後。
接下來便是處理執行的狀況，同樣根據資料所給定的policy來做區分，當中又分成可插隊(Preemptive)以及不可插隊(Non-Preemptive)，FIFO、SJF屬於不可插隊，當process進入waiting_list便不會改變先後順序，會按照waiting_list依依執行，而RR與PSJF就大不相同了。
RR會根據TIME_QUANTUM來決定一個process單次執行時間多久，若他的執行時間會超過TIME_QUANTUM，當時間到時，該process會被調至waiting_list的最尾端，剩下未執行完畢的部分會等到其餘的process都執行過後才會再繼續執行。
PSJF又更複雜了，由於無法在執行時同時知道後來process的exec_time是否會少於現在正在執行的process的剩餘時間，因此我們讓process一次執行一個unit，並且每次執行完後做檢查，假設發現後來的process執行時間短於現正執行process的剩餘時間時，後來的process便會在waiting_list中被往前移動，反之，現在執行的就會被後移，當沒有沒process執行時間比他短時，才會輪到他繼續執行。
執行期間我們利用systemcall檢測各個process的起始與終止時間，並將dmesg中的資料簡化印出，完整資料則在dmesg中。

## Test
FIFO 測資
```
FIFO
5
P1 0 500
P2 0 500
P3 0 500
P4 0 500
P5 0 500

FIFO
4
P1 0 80000
P2 100 5000
P3 200 1000
P4 300 1000

FIFO
7
P1 0 8000
P2 200 5000
P3 300 3000
P4 400 1000
P5 500 1000
P6 500 1000
P7 600 4000
```
FIFO 測資結果
```
[Project1] 3167 1526476863.202692849 1526476864.17707801
[Project1] 3168 1526476864.18556504 1526476864.783011833
[Project1] 3169 1526476864.783700635 1526476865.533776694
[Project1] 3170 1526476865.534456497 1526476866.320577592
[Project1] 3171 1526476866.321597696 1526476867.141750416
P1 3167
P2 3168
P3 3169
P4 3170
P5 3171

[Project1] 3174 1526476902.253216399 1526477025.183513307
[Project1] 3175 1526477025.184154508 1526477032.932092582
[Project1] 3176 1526477032.932773483 1526477034.447226130
[Project1] 3177 1526477034.447866930 1526477035.935860217
P1 3174
P2 3175
P3 3176
P4 3177

[Project1] 3184 1526477223.597811290 1526477235.703377479
[Project1] 3185 1526477235.703975994 1526477243.298930223
[Project1] 3186 1526477243.299614240 1526477247.872250742
[Project1] 3187 1526477247.872961259 1526477249.375177762
[Project1] 3188 1526477249.375919279 1526477250.882081855
[Project1] 3189 1526477250.882699869 1526477252.431700532
[Project1] 3190 1526477252.432226445 1526477258.599709388
P1 3184
P2 3185
P3 3186
P4 3187
P5 3188
P6 3189
P7 3190
```
RR 測資
```
RR
5
P1 0 500
P2 0 500
P3 0 500
P4 0 500
P5 0 500

RR
2
P1 600 4000
P2 800 5000

RR
6
P1 1200 5000
P2 2400 4000
P3 3600 3000
P4 4800 7000
P5 5200 6000
P6 5800 5000
```
RR 測資結果
```
[Project1] 3195 1526477420.835368910 1526477421.607805984
[Project1] 3196 1526477421.608461995 1526477422.371110293
[Project1] 3197 1526477422.371841804 1526477423.136567914
[Project1] 3198 1526477423.137182624 1526477423.901011894
[Project1] 3199 1526477423.901661404 1526477424.711722469
P1 3195
P2 3196
P3 3197
P4 3198
P5 3199

[Project1] 3206 1526477573.199698469 1526477583.760168948
[Project1] 3207 1526477574.744263728 1526477586.889942812
P1 3206
P2 3207

[Project1] 3214 1526477645.747211570 1526477670.125603853
[Project1] 3216 1526477651.46764374 1526477672.385082765
[Project1] 3215 1526477648.781237006 1526477674.724271144
[Project1] 3219 1526477657.94768519 1526477686.885265614
[Project1] 3218 1526477654.828903448 1526477689.870195834
[Project1] 3217 1526477654.83261563 1526477691.308922981
P1 3214
P2 3215
P3 3216
P4 3217
P5 3218
P6 3219
```
SJF 測資
```
SJF
4
P1 0 7000
P2 0 2000
P3 100 1000
P4 200 4000

SJF
5
P1 200 7000
P2 100 100
P3 200 4000
P4 100 4000
P5 200 200

SJF
8
P1 100 3000
P2 100 5000
P3 100 7000
P4 200 10
P5 200 10
P6 300 4000
P7 400 4000
P8 500 9000
```
SJF 測資結果
```
[Project1] 6882 83.288976925 86.390119966
[Project1] 6883 86.400561120 87.947180648
[Project1] 6884 87.951382630 94.157866230
[Project1] 6881 86.390593363 105.38545407
P1 6881
P2 6882
P3 6883
P4 6884

[Project1] 3260 1526478060.86398536 1526478060.235224295
[Project1] 3264 1526478060.235850368 1526478060.533412890
[Project1] 3261 1526478060.533860971 1526478066.558477808
[Project1] 3263 1526478066.602894735 1526478072.825865612
[Project1] 3262 1526478066.559148480 1526478083.517813833
P2 3260
P4 3261
P1 3262
P3 3263
P5 3264

[Project1] 3269 1526478144.624740030 1526478149.268244073
[Project1] 3272 1526478149.290171169 1526478149.306649465
[Project1] 3273 1526478149.307193445 1526478149.323113061
[Project1] 3274 1526478149.323632442 1526478155.545755017
[Project1] 3275 1526478155.564818724 1526478161.845194541
[Project1] 3270 1526478149.269087443 1526478169.600258525
[Project1] 3271 1526478169.600881103 1526478180.545390481
[Project1] 3276 1526478180.545959461 1526478194.604307211
P1 3269
P2 3270
P3 3271
P4 3272
P5 3273
P6 3274
P7 3275
P8 3276
```
PSJF 測資
```
PSJF
4
P1 0 10000
P2 1000 7000
P3 2000 5000
P4 3000 3000

PSJF
5
P1 0 3000
P2 1000 1000
P3 2000 4000
P4 5000 2000
P5 7000 1000

PSJF
4
P1 0 2000
P2 500 500
P3 1000 500
P4 1500 500
```
PSJF 測資結果
```
[Project1] 3288 1526478298.732768452 1526478303.360972786
[Project1] 3287 1526478297.186734119 1526478309.515488130
[Project1] 3286 1526478295.652961742 1526478318.942459355
[Project1] 3285 1526478294.43554062 1526478332.887546094
P1 3285
P2 3286
P3 3287
P4 3288

[Project1] 3295 1526478424.176786024 1526478425.710106205
[Project1] 3294 1526478422.630056691 1526478428.777868540
[Project1] 3297 1526478430.366040994 1526478433.449407314
[Project1] 3298 1526478433.450002002 1526478434.986126622
[Project1] 3296 1526478428.778396630 1526478439.644877966
P1 3294
P2 3295
P3 3296
P4 3297
P5 3298

[Project1] 3304 1526478506.353508780 1526478507.111312030
[Project1] 3305 1526478507.111978917 1526478507.885332895
[Project1] 3306 1526478507.886026782 1526478508.658671688
[Project1] 3303 1526478505.586322217 1526478510.966873566
P1 3303
P2 3304
P3 3305
P4 3306
```

## Analysis
每組測資第一個圖表為實際時間，第二個圖表為理論時間
### FIFO
![](https://i.imgur.com/rzaSAkM.png)
### RR
![](https://i.imgur.com/xMr5j1E.png)
### SJF
![](https://i.imgur.com/g7rOiE7.png)
### PSJF
![](https://i.imgur.com/3oOA9xA.png)


### 理論與實際結果的差異
- Scheduler 本身執行所需要的時間
- 同樣執行 1000000 次迴圈，但 CPU 所需要花的時間不一定完全一樣



## Member
蘇多門: Adding System Call, Report(Analysis, Simulation program)
王行健: Scheduler Program(FIFO, RR, fork process)
余庭光: Scheduler Program(PSJF, SJF), Report(Design, Test)
